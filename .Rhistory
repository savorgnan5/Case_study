head(brew)
combined<- merge(brew, beers,by = "Brew_ID")
# renaming Name.x to Brewery_Name
colnames(combined)[2] <- "Brewery_Name"
# renaming Name.y to Beer_Name
colnames(combined)[5] <- "Beer_Name"
head(combined, 6)
tail(combined, 6)
na_count <-sapply(combined, function(y) sum(length(which(is.na(y)))))
na_count
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE), Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
ggplot(data=plot1, aes(x= State, y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=LAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= State,-IBU), y=IBU, fill= ABV) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=LB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=LAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=HB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE), Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=LAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
summary(beers$ABV)
boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
cor.test(combined$ABV, combined$IBU, na.action(na.omit("NA")))
beer.lm <- lm(combined$IBU ~ combined$ABV, na.action(na.omit("NA")))
summary(beer.lm)
ggplot(dat= plot1,
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
read.csv(file = "data/population.csv", header = T) -> state_population
state_population$State <- as.character(state_population$State)
# Merging census data into brewery by state data, the merged data is combined_pop
merge(numBreweries, state_population, by = "State") -> combined_pop
# tests R correlation between Breweries & Total Population By State
cor(combined_pop$Population, combined_pop$numBreweries)
# predicting number of breweries based on population
brew_pop.lm <- lm(combined_pop$numBreweries ~ combined_pop$Population)
summary(brew_pop.lm)
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
merge(albrew, state_population, by = "State") ->alpop
head(alpop)
plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State)) + geom_col() + labs(title = "Breweries Per State") + theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
+ geom_col() + labs(title = "Breweries Per State") +
theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State)) + geom_col() + labs(title = "Breweries Per State", xlab= "State", ylab= "Number of Breweries") + theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", xlab= "State", ylab= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", x= "State", y= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
ggplot(data=LAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
merge(albrew, state_population, by = "State") ->alpop
head(alpop)
plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
library(dplyr)
library(ggplot2)
library(tidyr)
library(reshape2)
library(tidyverse)
## We are loading the dataset from the beers and the dataset from breweries in the chunk code below.
##The beers dataset is bears, the breweries dataset is brew.
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Beers.csv"
beers <- read.csv(url(url), sep = ",", header = TRUE)
head(beers)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Breweries.csv"
brew <- read.csv(url(url), sep = ",", header = TRUE)
head(brew)
## QUESTION 1: BREWERIES PER STATE
## In the following code we count how many breweries are pers state in the US territory.NumBreweries describe the
## amount of breweries per state in the US territory.Then we ordered in descending order. Colorado and California
## are the states with the highest amount of breweries in their state.
# changing from factor to char
brew$State <- as.character(brew$State)
# changing to int
brew$Brew_ID <- as.integer(brew$Brew_ID)
# changing to char
brew$Name <-  as.character(brew$Name)
# removing trailing whitespace
str_trim(brew$State, side = "left") -> brew$State
brew %>% group_by(State) %>% summarize(numBreweries = n_distinct(Name)) -> numBreweries
numBreweries
numBreweries <- arrange(numBreweries, desc(numBreweries))
numBreweries
tail(numBreweries)
# creating chart for breweries
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", x= "State", y= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
## QUESTION 2: MERGED DATA SET
## In the following code chunk we merge beer data with the breweries data. We print the first 6 observations and
## the last six observations to check the merged file in order to explore the dataset. Combined is the combined dataset.
beers$Brew_ID<-beers$Brewery_id
beers$Brewery_id<-NULL
head(beers)
head(brew)
combined<- merge(brew, beers,by = "Brew_ID")
# renaming Name.x to Brewery_Name
colnames(combined)[2] <- "Brewery_Name"
# renaming Name.y to Beer_Name
colnames(combined)[5] <- "Beer_Name"
head(combined, 6)
tail(combined, 6)
## QUESTION 3: MISSING DATA
## In the following chunk code we report the number of NA's in each column of the combined dataset. NA_count is the amount
## of NA in each column in the combined dataset.
na_count <-sapply(combined, function(y) sum(length(which(is.na(y)))))
na_count
## QUESTION 4: MEDIAN ALCOHOL CONTENT
## We compute the median alcohol content and international bitterness unit in a beer for each state from the combined dataset.
## in order to compute the alcohol content and international bitterness unit in a beer for each state from the combined dataset
## We grouped the combined dataset by State, then we sumarized by alcohol content and international bitterness unit per beer using
## the median function. We decided to get rid of the NA values, we used the pipe function from the dplyr library to design this code.
## The final product of the function is plot1.
## We Plot a bar chart to compare the median alcohol content and international bitterness unit per beer for each state
## from the combined dataset. We used the ggplot library to perform the plot.
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE), Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
# The top 5 state with more alcohol content, which is HAC_S, and the top 5 state with the most bitter beer, which is HB_S
#Furtheremore, we proceed to plot HAC_S and HB_S
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
# The bottom 5 lowest state with alcohol content, which is LAC_S, and the bottom 5 lowest state with bitter beer, which is LB_S
#Furtheremore, we proceed to plot HAC_S and HB_S
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
ggplot(data=LAC_S, aes(x= reorder(State,-ABV), y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= reorder(State,-IBU), y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
## QUESTION 5: MAX IBU & ABV STATES
## The following code show the state with the maximum alcoholic (ABV) beer, and the state with
## the most bitter (IBU) beer.The maximum alcoholic (ABV) beer, and bitter (IBU) beer is represented by maxal.
#### Max ABV and IBU and the state
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
# Highest Alcohol Content is HAC, the highest alcohol content per state is HAC_S
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
# Highest Bitterness is HB, the highest bitterness per state is HB_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
## QUESTION 6: SUMMARY STATS FOR ABV
##Summary statistics for the ABV variable from the beers dataset.
summary(beers$ABV)
boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen")
## QUESTION 7: ABV & IBU RELATIONSHIP
# Scatterplot between Alcohol & Bitterness
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
# tests R correlation between ABV & IBU ignoring NA entries
cor.test(combined$ABV, combined$IBU, na.action(na.omit("NA")))
# predicting bitterness based on alcohol content
beer.lm <- lm(combined$IBU ~ combined$ABV, na.action(na.omit("NA")))
summary(beer.lm)
## In the following code using ggplot we draw a scatter plot between the bitterness and alcohol content.
## It look like there is a trend toward a llinear relatioship between the 2 mentioned variable, p3 is the plot.
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
## In the following code we found frequest beers style and name in the US territory.
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
## ADDITIONAL QUESTION USING CENSUS DATA
## NOTE WAS IN EXCEL SO NEEDED TO MANUALLY CLEAN
## 2018 Census Data on https://www.census.gov
read.csv(file = "data/population.csv", header = T) -> state_population
state_population$State <- as.character(state_population$State)
# Merging census data into brewery by state data, the merged data is combined_pop
merge(numBreweries, state_population, by = "State") -> combined_pop
# tests R correlation between Breweries & Total Population By State
cor(combined_pop$Population, combined_pop$numBreweries)
# predicting number of breweries based on population
brew_pop.lm <- lm(combined_pop$numBreweries ~ combined_pop$Population)
summary(brew_pop.lm)
# Scatterplot Between Breweries & Total Population By State
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
#Examining correlation between Number of Breweries and Median Alcohol Content.The dataset albrew have the variable
# numbber of breweries from the dataset numBreweries created previously and the mediam alcohol content per bear from
# the dataset plot1 created before. So we combined the plot1 dataset and the numBreweries dataset. Furthermore, we
# proceeded to plot the relationship between the number of breweries and the median alcohol content.
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
# Examining correlation between population and median alcohol content.The dataset albrew have the variable
# numbber of breweries from the dataset numBreweries created previously and the mediam alcohol content per bear from
# the dataset plot1 created before. So we combined the albrew with the state_population datatset from the census bureau
#in order to have the population variable added to the albrew dataset. The combined dataset of the albrew and satate_population
# in the alpop dataset. Furthermore, we proceeded to plot the relationship between the population per state and the median
# alcohol content.
merge(albrew, state_population, by = "State") ->alpop
head(alpop)
plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
# outputting file
# write.csv(combined_pop, file = "casestudy/combined_pop.csv", row.names = F)
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", x= "State", y= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
g2 <-g
g3<-g2+coord_flip(ylim=c(.04,.0650))
g4<-g3+theme(legend.position='none')
g5<-g4+
scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')+
theme_classic()+labs(x="State", y="ABV", legend="ABV")+
ggtitle("Median ABV by state") +
theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g5
gplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
g <-ggplot(StateSummary, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV)) +
geom_bar(stat="identity")
g2 <-g
g3<-g2+coord_flip(ylim=c(.04,.0650))
g4<-g3+theme(legend.position='none')
g5<-g4+
scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')+
theme_classic()+labs(x="State", y="ABV", legend="ABV")+
ggtitle("Median ABV by state") +
theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g5
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
g <-ggplot(StateSummary, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV)) +
geom_bar(stat="identity")
g2 <-g
g3<-g2+coord_flip(ylim=c(.04,.0650))
g4<-g3+theme(legend.position='none')
g5<-g4+
scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')+
theme_classic()+labs(x="State", y="ABV", legend="ABV")+
ggtitle("Median ABV by state") +
theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g5
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
g <-ggplot(StateSummary, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV)) +
geom_bar(stat="identity")
g2 <-g
g3<-g2+coord_flip(ylim=c(.04,.0650))
g4<-g3+theme(legend.position='none')
g5<-g4+
scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')+
theme_classic()+labs(x="State", y="ABV", legend="ABV")+
ggtitle("Median ABV by state") +
theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g5
g <-ggplot(StateSummary, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV)) +
geom_bar(stat="identity")
g2 <-g
g3<-g2+coord_flip(ylim=c(.04,.0650))
g4<-g3+theme(legend.position='none')
g5<-g4+ scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')
g6<-g5 +theme_classic()+labs(x="State", y="ABV", legend="ABV")+ ggtitle("Median ABV by state")
g7<- g6 +theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
g1<-ggplot(StateSummary, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV))
g2 <- g1 + geom_bar(stat="identity")
g3<-g2+coord_flip(ylim=c(.04,.0650))
g4<-g3+theme(legend.position='none')
g5<-g4+ scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')
g6<-g5 +theme_classic()+labs(x="State", y="ABV", legend="ABV")+ ggtitle("Median ABV by state")
g7<- g6 +theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
g1= ggplot(StateSummary, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV))
g2=  g1 + geom_bar(stat="identity")
g3= g2+coord_flip(ylim=c(.04,.0650))
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="ABV", legend="ABV")+ ggtitle("Median ABV by state")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
g1= ggplot(plot1, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=medianABV))
g2=  g1 + geom_bar(stat="identity")
g3= g2+coord_flip(ylim=c(.04,.0650))
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="ABV", legend="ABV")+ ggtitle("Median ABV by state")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
g1= ggplot(plot1, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=Bitterness))
g2=  g1 + geom_bar(stat="identity")
g3= g2+coord_flip(ylim=c(.04,.0650))
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="ABV", legend="ABV")+ ggtitle("Median ABV by state")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", x= "State", y= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
tail(numBreweries)
numBreweries
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim=c(1,46))
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip()
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim=c(1.0, 40.0))
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim=40)
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim=0.4)
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim= 40)
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", x= "State", y= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar()
g3= g2+coord_flip(ylim= 40)
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim= 40)
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=mean(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
numBreweries
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip(ylim= 40)
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint= 22,low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_bar(stat="identity")
g3= g2+coord_flip()
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=mean(numBreweries$numBreweries),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="Nunber of Breweries", legend="Nunber of Breweries")+ ggtitle("Breweries Per State")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
p1= numBreweries %>% ggplot(aes(x = reorder(State,-numBreweries),  y = numBreweries, fill = State))
p2= p1+ geom_col() + labs(title = "Breweries Per State", x= "State", y= "Number of Breweries")
p3= p2+ theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
p3
ggplot(data=plot1, aes(x= reorder(State,-Alcohol_content), y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
g1= ggplot(plot1, aes(x=reorder(State,-Alcohol_content),y=Alcohol_content, fill=Bitterness))
g2=  g1 + geom_bar(stat="identity")
g3= g2+coord_flip(ylim=c(.04,.0650))
g4= g3+theme(legend.position='none')
g5= g4+ scale_fill_gradient2(midpoint=median(plot1$Alcohol_content),low='red', mid='snow3', high='black', space='Lab')
g6= g5+theme_classic()+labs(x="State", y="ABV", legend="ABV")+ ggtitle("Median ABV by state")
g7= g6+theme(plot.title = element_text(hjust = 0.5),axis.text=element_text(size=5))
g7
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot_grid(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
plot_grid(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot_grid(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
grid(plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content"))
abline(brew_pop.lm, col = "red")
merge(albrew, state_population, by = "State") ->alpop
head(alpop)
grid(plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content"))
abline(brew_pop.lm, col = "red")
grid(plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries"))
abline(brew_pop.lm, col = "red")
boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen")
grid(boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen"))
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
grid(plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness"))
