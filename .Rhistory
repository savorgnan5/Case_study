ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
## In the following code we found frequest beers style and name in the US territory.
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
cor.test(combined$ABV, combined$IBU, na.action(na.omit("NA")))
beer.lm <- lm(combined$IBU ~ combined$ABV, na.action(na.omit("NA")))
summary(beer.lm)
beer.lm <- lm(combined$IBU ~ combined$ABV, na.action(na.omit("NA")))
summary(beer.lm)
summary(beer.lm)
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
## In the following code we found frequest beers style and name in the US territory.
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
read.csv(file = "data/population.csv", header = T) -> state_population
state_population$State <- as.character(state_population$State)
# merging census data into brewery by state data
merge(numBreweries, state_population, by = "State") -> combined_pop
cor(combined_pop$Population, combined_pop$numBreweries)
brew_pop.lm <- lm(combined_pop$numBreweries ~ combined_pop$Population)
summary(brew_pop.lm)
plot(combined_pop$Population, combined_pop$numBreweries)
abline(brew_pop.lm, col = "red")
plot1
library(dplyr)
library(ggplot2)
library(tidyr)
library(reshape2)
library(tidyverse)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Beers.csv"
beers <- read.csv(url(url), sep = ",", header = TRUE)
head(beers)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Breweries.csv"
brew <- read.csv(url(url), sep = ",", header = TRUE)
head(brew)
brew$State <- as.character(brew$State)
# changing to int
brew$Brew_ID <- as.integer(brew$Brew_ID)
# changing to char
brew$Name <-  as.character(brew$Name)
str_trim(brew$State, side = "left") -> brew$State
brew$State
brew %>% group_by(State) %>% summarize(numBreweries = n_distinct(Name)) -> numBreweries
numBreweries
numBreweries <- arrange(numBreweries, desc(numBreweries))
numBreweries
numBreweries %>% ggplot(aes(x = State, y = numBreweries, fill = State)) + geom_col() + labs(title = "Breweries Per State") + theme( axis.text = element_text(size = rel(0.4)) )
numBreweries %>% ggplot(aes(x = State, y = numBreweries, fill = State)) + geom_col() + labs(title = "Breweries Per State") + theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
beers$Brew_ID<-beers$Brewery_id
beers$Brewery_id<-NULL
head(beers)
head(brew)
combined<- merge(brew, beers,by = "Brew_ID")
colnames(combined)[2] <- "Brewery_Name"
# renaming Name.y to Beer_Name
colnames(combined)[5] <- "Beer_Name"
head(combined, 6)
tail(combined, 6)
na_count <-sapply(combined, function(y) sum(length(which(is.na(y)))))
na_count
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE), Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
ggplot(data=plot1, aes(x= State, y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
View(beers)
summary(beers$ABV)
plot(combined$ABV, combined$IBU)
p1= ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness))
p2= p1 +geom_point(shape=1) + geom_smooth(method = "lm")
p3= p2 + ggtitle("Bitterness per Alcohol Content")
p3
plot(combined$ABV, combined$IBU)
plot(combined$ABV, combined$IBU, main="Scatterplot btween Alcohol & Bitterness", xlab = "Alcohol Content", ylab = Alcohol Bitterness)
plot(combined$ABV, combined$IBU, main="Scatterplot btween Alcohol & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
cor.test(combined$ABV, combined$IBU, na.action(na.omit("NA")))
beer.lm <- lm(combined$IBU ~ combined$ABV, na.action(na.omit("NA")))
summary(beer.lm)
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
read.csv(file = "data/population.csv", header = T) -> state_population
state_population$State <- as.character(state_population$State)
merge(numBreweries, state_population, by = "State") -> combined_pop
cor(combined_pop$Population, combined_pop$numBreweries)
brew_pop.lm <- lm(combined_pop$numBreweries ~ combined_pop$Population)
summary(brew_pop.lm)
plot(combined_pop$Population, combined_pop$numBreweries)
abline(brew_pop.lm, col = "red")
BeersStyle
View(numBreweries)
plot(combined_pop$Population, combined_pop$numBreweries,  main="Scatterplot Between Breweries & Total Population By State", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
plot(combined_pop$Population, combined_pop$numBreweries,  main="Relationship Between Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
boxplot(beers$ABV)
SABV<-summary(beers$ABV)
SABV
boxplot(beers$ABV)
p<-boxplot(beers$ABV)
p
SABV<-summary(beers$ABV)
p<-boxplot(beers$ABV)
p
SABV<-summary(beers$ABV)
p<-boxplot(SABV)
p
summary(beers$ABV)
boxplot(summary(beers$ABV))
summary(beers$ABV)
boxplot(beers$ABV)
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
boxplot(beers$ABV, main=toupper("Alcohol Content"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen")
boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
View(combined)
View(state_population)
plot1
numBreweries
combined_pop
combined_pop
View(combined_pop)
plot
numBreweries
plot1
albrew<- combine(plot1, numBreweries, by= "State")
class(plot1)
plot1<-as.data.frame(plot1)
class(numBreweries)
numBreweries<-as.data.frame(numBreweries)
class(numBreweries)
class(plot1)
albrew<- combine(plot1, numBreweries, by= "State")
albrew<- merge(plot1,numBreweries, by= "State")
albrew
albrew$Median_Alcohol_Content<-albrew$Alcohol_content
head(albrew)
albrew$Alcohol_content<-albrew$Median_Alcohol_Content
head(albrew)
plot(albrew$numBreweries, albrew$Median_Alcohol_Content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
albrew$Alcohol_content<-albrew$Median_Alcohol_Content
head(albrew)
plot(albrew$numBreweries, albrew$Median_Alcohol_Content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
plot(albrew$numBreweries, albrew$Median_Alcohol_Content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
albrew$Alcohol_content<-albrew$Median_Alcohol_Content
head(albrew)
albrew<- merge(plot1,numBreweries, by= "State")
albrew
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
merge(albrew, state_population, by = "State") ->alpop
head(alpop)
plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
# Highest Bitterness
head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
head(beers[order(plot1$Alcohol_content, decreasing = T, na.last = T),],1)
head(plot1[order(plot1$Alcohol_content, decreasing = T, na.last = T),],1)
head(plot1[order(plot1$Bitterness, decreasing = T, na.last = T),],1)
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S
HAC_S<-head(plot1[order(plot1$Alcohol_content, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_s<- head(plot1[order(plot1$Bitterness, decreasing = T, na.last = T),],1)
HB_S<- head(plot1[order(plot1$Bitterness, decreasing = T, na.last = T),],1)
HB_S
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
plot1
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(plot1[order(plot1$Alcohol_content, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<- head(plot1[order(plot1$Bitterness, decreasing = T, na.last = T),],1)
HB_S
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(plot1[order(plot1$Alcohol_content, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<- head(plot1[order(plot1$Bitterness, decreasing = T, na.last = T),],1)
HB_S
plot1
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
HB
HB_S<-head(plot1[order(plot1$Bitterness_content, decreasing = T, na.last = T),],1)
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(plot1[order(plot1$Alcohol_content, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(plot1[order(plot1$Bitterness_content, decreasing = T, na.last = T),],1)
HB_S<-head(plot1[order(plot1$Bitterness, decreasing = T, na.last = T),],1)
HB_S
View(beers)
combined %>% group_by(State) %>% summarize(Alcohol_content = max(ABV, na.rm = TRUE)) ->HAC_S
HAC_S
combined %>% group_by(State) %>% summarize(Alcohol_content = max(ABV, na.rm = TRUE)) ->HAC_S
HAC_S
combined %>% group_by(State) %>% summarize(Alcohol_content = max(ABV, na.rm = TRUE)) %>% order(desc(Alcohol_content)) ->HAC_S
HAC_S
View(combined)
combined %>% group_by(State) %>% order(desc(Alcohol_content)) %>% summarize(Alcohol_content = max(ABV, na.rm = TRUE)) ->HAC_S
HAC_S
combined %>% group_by(State) %>% order(desc(Alcohol_content)) %>% summarize(Alcohol_content = sum(ABV, na.rm = TRUE)) ->HAC_S
HAC_S
combined %>% group_by(State) %>% order(desc(Alcohol_content)) %>% summarize(Alcohol_content = ABV, na.rm = TRUE) ->HAC_S
HAC_S
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
head(combined, 6)
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
library(dplyr)
library(ggplot2)
library(tidyr)
library(reshape2)
library(tidyverse)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Beers.csv"
beers <- read.csv(url(url), sep = ",", header = TRUE)
head(beers)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Breweries.csv"
brew <- read.csv(url(url), sep = ",", header = TRUE)
head(brew)
# changing from factor to char
brew$State <- as.character(brew$State)
# changing to int
brew$Brew_ID <- as.integer(brew$Brew_ID)
# changing to char
brew$Name <-  as.character(brew$Name)
# removing trailing whitespace
str_trim(brew$State, side = "left") -> brew$State
brew %>% group_by(State) %>% summarize(numBreweries = n_distinct(Name)) -> numBreweries
numBreweries
numBreweries <- arrange(numBreweries, desc(numBreweries))
numBreweries
numBreweries %>% ggplot(aes(x = State, y = numBreweries, fill = State)) + geom_col() + labs(title = "Breweries Per State") + theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
beers$Brew_ID<-beers$Brewery_id
beers$Brewery_id<-NULL
head(beers)
head(brew)
combined<- merge(brew, beers,by = "Brew_ID")
# renaming Name.x to Brewery_Name
colnames(combined)[2] <- "Brewery_Name"
# renaming Name.y to Beer_Name
colnames(combined)[5] <- "Beer_Name"
head(combined, 6)
tail(combined, 6)
na_count <-sapply(combined, function(y) sum(length(which(is.na(y)))))
na_count
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE), Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
ggplot(data=plot1, aes(x= State, y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
plot1
combined %>% group_by(State) %>% summarize(Alcohol_content = max(ABV, na.rm = TRUE)) order(desc(Alcohol_content))->topA
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],5)
HAC_S
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],5)
HB_S
HB_S
HAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=HB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],5)
HAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
LAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
LAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],6)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],6)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
library(dplyr)
library(ggplot2)
library(tidyr)
library(reshape2)
library(tidyverse)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Beers.csv"
beers <- read.csv(url(url), sep = ",", header = TRUE)
head(beers)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Breweries.csv"
brew <- read.csv(url(url), sep = ",", header = TRUE)
head(brew)
# changing from factor to char
brew$State <- as.character(brew$State)
# changing to int
brew$Brew_ID <- as.integer(brew$Brew_ID)
# changing to char
brew$Name <-  as.character(brew$Name)
str_trim(brew$State, side = "left") -> brew$State
str_trim(brew$State, side = "left") -> brew$State
brew %>% group_by(State) %>% summarize(numBreweries = n_distinct(Name)) -> numBreweries
numBreweries
numBreweries <- arrange(numBreweries, desc(numBreweries))
numBreweries
numBreweries %>% ggplot(aes(x = State, y = numBreweries, fill = State)) + geom_col() + labs(title = "Breweries Per State") + theme( axis.text = element_text(size = rel(0.4),angle =45, hjust = 1, vjust = 1) )
beers$Brew_ID<-beers$Brewery_id
beers$Brewery_id<-NULL
head(beers)
head(brew)
combined<- merge(brew, beers,by = "Brew_ID")
# renaming Name.x to Brewery_Name
colnames(combined)[2] <- "Brewery_Name"
# renaming Name.y to Beer_Name
colnames(combined)[5] <- "Beer_Name"
head(combined, 6)
tail(combined, 6)
na_count <-sapply(combined, function(y) sum(length(which(is.na(y)))))
na_count
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE), Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
ggplot(data=plot1, aes(x= State, y=Alcohol_content, fill= Bitterness)) + geom_bar(stat="identity") + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
# The top 5 state with more alcohol content
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],6)
HAC_S
ggplot(data=HAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Top State per Alcohol Content") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],6)
HB_S
ggplot(data=HB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Top State per Beer Bitterness") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
HAC<- head(beers[order(beers$ABV, decreasing = T, na.last = T),],1)
HAC
HAC_S<-head(combined[order(combined$ABV, decreasing = T, na.last = T),],1)
HAC_S
HB<-head(beers[order(beers$IBU, decreasing = T, na.last = T),],1)
HB
HB_S<-head(combined[order(combined$IBU, decreasing = T, na.last = T),],1)
HB_S
summary(beers$ABV)
boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen")
plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness")
# tests R correla
cor.test(combined$ABV, combined$IBU, na.action(na.omit("NA")))
beer.lm <- lm(combined$IBU ~ combined$ABV, na.action(na.omit("NA")))
summary(beer.lm)
ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness)) + geom_point(shape=1) + geom_smooth(method = "lm") + ggtitle("Bitterness per Alcohol Content")
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
BeersStyle
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
BeersName
read.csv(file = "data/population.csv", header = T) -> state_population
state_population$State <- as.character(state_population$State)
# merging census data into brewery by state data
merge(numBreweries, state_population, by = "State") -> combined_pop
cor(combined_pop$Population, combined_pop$numBreweries)
brew_pop.lm <- lm(combined_pop$numBreweries ~ combined_pop$Population)
summary(brew_pop.lm)
plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries")
abline(brew_pop.lm, col = "red")
numBreweries<-as.data.frame(numBreweries)
plot1<-as.data.frame(plot1)
albrew<- merge(plot1,numBreweries, by= "State")
head(albrew)
plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
merge(albrew, state_population, by = "State") ->alpop
head(alpop)
plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content")
abline(brew_pop.lm, col = "red")
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
LAC_S<-tail(combined[order(combined$ABV, decreasing = T, na.last = F),],6)
LAC_S
ggplot(data=LAC_S, aes(x= State, y=ABV, fill= IBU)) + geom_bar(stat="identity") + ggtitle("Lowest per Alcohol Content per State") + labs(x= "States",  y= "Alcohol Content") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
LB_S<-tail(combined[order(combined$IBU, decreasing = T, na.last = F),],7)
LB_S
ggplot(data=LB_S, aes(x= State, y=IBU, fill= ABV)) + geom_bar(stat="identity") + ggtitle("Lowest Beer Bitterness per State") + labs(x= "States",  y= "Beer Bitterness") + theme(axis.text.x = element_text(size =8, angle =45, hjust = 1, vjust = 1))
