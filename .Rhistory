library(dplyr)
library(ggplot2)
library(tidyr)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Beers.csv"
beers <- read.csv(url(url), sep = ",", header = TRUE)
head(beers)
url<-"https://raw.githubusercontent.com/BivinSadler/MSDS-6306-Doing-Data-Science/master/Unit%207/Breweries.csv"
brew <- read.csv(url(url), sep = ",", header = TRUE)
head(brew)
brew$State<- as.character(brew$State)
brew$Brew_ID<- as.integer(brew$Brew_ID)
brew$Name<-  as.character(brew$Name)
brew %>% group_by(State) %>% summarize(numBreweries = n_distinct(Name)) -> numBreweries
numBreweries
numBreweries$numBreweries<- as.integer(numBreweries$numBreweries)
numBreweries <- arrange(numBreweries, desc(numBreweries))
numBreweries
beers$Brew_ID<-beers$Brewery_id
beers$Brewery_id<-NULL
head(beers)
head(brew)
combined<- merge(brew, beers,by = "Brew_ID")
head(combined, 6)
tail(combined, 6)
na_count <-sapply(combined, function(y) sum(length(which(is.na(y)))))
na_count
combined %>% group_by(State) %>% summarize(Alcohol_content = median(ABV, na.rm = TRUE),
Bitterness= median(IBU, na.rm = TRUE)) ->plot1
plot1
p1= ggplot(data=plot1, aes(x= State, y=Alcohol_content, fill= Bitterness))
p2= p1 + geom_bar(stat="identity")
p3= p2 + ggtitle("Bitterness per Alcohol Content") + labs(x= "States",  y= "Alcohol Content")
p4= p3 + theme(axis.text.x = element_text(size =4 , angle =45, hjust = 1, vjust = 1))
p4
maxal<- sapply(plot1, max, na.rm = TRUE)
maxal
summary(beers$ABV)
p1= ggplot(dat= plot1, aes(x= Alcohol_content, y= Bitterness))
p2= p1 +geom_point(shape=1) + geom_smooth(method = "lm")
p3= p2 + ggtitle("Bitterness per Alcohol Content")
p3
