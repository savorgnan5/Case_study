---
title: "Case Study 1"
author: "Fabio Savorgnan"
date: "6/24/2019"
output: ioslides_presentation
---

```{r setup, include=FALSE}
source("Case_study_Codebook.R")
knitr::opts_chunk$set(echo = FALSE)
```


## Case Study 1

- ***Bitterness & Concentration Across US Breweries***

- ***SMU - DDS 6306***

- ***Members:*** 
  
  Fabio Savorgnan
  
  Jeremy Otsap


## Overview
- ***Beer Data Set***                                                     

**Name:** Name of the beer.
**Beer_ID:** Unique identifier of the beer.
**ABV:** Alcohol by volume of the beer.
**IBU:** International Bitterness Units of the beer.
**Brewery_ID:** Brewery id associated with the beer.
**Style:** Style of the beer.
**Ounces:** Ounces of beer.

- ***Brewery Data Set***

**Brew_ID:** Unique identifier of the brewery.
**Name:** Name of the brewery.
**City:** City where the brewery is located.
**State:** U.S. State where the brewery is located.
  
## Introduction: Given the datasets Beer and Brews, we want to know

- ***Where our headquarters should be?***

- ***What style and name of beer would appeal to the widest audience?***

- ***What ABV and IBU should be used for the production of beers?***


## Combined Data Set
 - ***The first 6 observations***
 
```{r,message=F, warning = F }
library(kableExtra)
head(combined, 6)%>% kable %>% kable_styling(bootstrap_options = c('striped', 'condensed'), font_size = 12)

``` 
## Combined Data Set
- ***The last 6 observations***

```{r,message=F, warning = F }
library(kableExtra)
tail(combined, 6)%>% kable %>% kable_styling(bootstrap_options = c('striped', 'condensed'), font_size = 12)

``` 

## Missing values

- ***Alcohol by Volume – 62 of 2410 entries were missing. ~2.57%***

- ***International Bitterness – 1005 of 2410 entries were missing. ~41.7%***

- ***NOTE: Bitterness data not available for South Dakota***


```{r }
na_count%>% kable %>% kable_styling(bootstrap_options = c('striped', 'condensed'), font_size = 11)
``` 
## Breweries Per State
***Top 4 States:*** -Colorado -California -Michigan -Oregon

***Bottom 4 States:*** -DC -South Dakota -North Dakota -West Virginia
```{r }
p3 
``` 


## Median Alcohol & Bitterness By State

```{r }
g7
``` 

## The top 5 state with more alcohol content


```{r }
x1+ theme_minimal()
```

## The top 5 state with the most bitter beer

```{r }
x2 + theme_minimal()
```


## The bottom 5 lowest state with alcohol content

```{r }
x3 + theme_minimal()
```


## The bottom 5 lowest state with bitterness per beer

```{r }
x4 + theme_minimal()
```

## Alcohol Content {.columns-2}
  - ***Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale***
  
  - ***12.8% AB***
  
  - ***Colorado***
```{r, echo=FALSE, out.width='480px'}
boxplot(beers$ABV, main=toupper("Alcohol Content in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Alcohol Content", font.lab=3, col="darkgreen") 
```

## Highest Bitterness Beer {.columns-2}
- ***Bitter Bitch Imperial IPA***

- ***IBU of 138***

- ***Oregon***
```{r,echo=FALSE, out.width='480px'}
boxplot(beers$IBU, main=toupper("Bitterness in Beers"), font.main=3, cex.main=1.2, xlab="Beers", ylab="Bitterness", font.lab=3, col="darkgreen") 
```


## Relationship Between Bitterness & Alcohol Content {.columns-2}

- ***Correlation: 67.06%***

- ***R-squared: 44.97%***

- ***This shows a moderate correlation between the bitterness and strength of the alcohol. About 45% of the bitterness of a particular beer is accounted for by its alcohol content***

```{r, echo=FALSE , out.width='450px'}
grid(plot(combined$ABV, combined$IBU, main="Scatterplot Between Alcohol Content & Bitterness", xlab = "Alcohol Content", ylab = "Alcohol Bitterness"))

```


## Examining correlation between state population and number of breweries {.columns-2} 

- ***There appears to be a moderate correlation of 62.1%***

- ***The R-squared value is 38.57% which means that almost 39% of the brewery density can be explained by the respective state’s total population***

```{r, echo=FALSE, out.width='450px' }
grid(plot(combined_pop$Population, combined_pop$numBreweries,main="Relationship of Breweries & Total Population", xlab = "Population by State", ylab = "Number of Breweries"))
abline(brew_pop.lm, col = "red") 

```

## Correlation between number of breweries and median alcohol content

- ***Cor : 0.1853568***

```{r, echo=FALSE }
grid(plot(albrew$numBreweries, albrew$Alcohol_content, main="Relationship Median Alcohol and Breweries", xlab = "Number of Breweries", ylab = "Median Alcohol Content"))
abline(brew_pop.lm, col = "red") 
```

## Correlation between population and median alcohol content
- ***Corr : 0.07961581. Adjusted R-squared:  -0.01394***
```{r, echo=FALSE }
grid(plot(alpop$Population, alpop$Alcohol_content, main="Relationship Median Alcohol and Population", xlab = "Population", ylab = "Median Alcohol Content"))
abline(brew_pop.lm, col = "red") 
```

## Most popular beer style in the US

- ***Most popular beer  style in the US: American IPA.*** 

```{r, echo=FALSE }
beers %>% count(Style) %>% arrange(desc(n)) -> BeersStyle
head(BeersStyle, 1)%>% kable %>% kable_styling(bootstrap_options = 'striped') 
```

## Most popular beer name in the US

- ***Most popular beer name in the US: Nonstop Hef Hop***

```{r, echo=FALSE }
beers %>% count(Name) %>% arrange(desc(n)) -> BeersName
head(BeersName,1)%>% kable %>% kable_styling(bootstrap_options = 'striped') 
```


## Conclusion 

- ***Headquarter in Mississippi.***

- ***The style of beer American IPA. ***

- ***The name of the beer Nonstop Hef Hop.***

- ***For an average ABV beer at 0.06 the recommended IBU is roughly 40.***

- ***Location where is less breweries regardless of the population.***


## Questions
